<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="6" MadCap:lastHeight="1752" MadCap:lastWidth="1056" class="">
    <head><title></title>
        <link rel="stylesheet" href="XModProHelp.css" type="text/css" />
    </head>
    <body>
        <h1>&lt;ControlDataSource&gt;</h1><a name="top"></a>
        <p class="Nav"><a href="#syntax">Syntax</a>&#160;<a href="#remarks">Remarks</a>&#160;<a href="#example">Example</a></p>
        <p>Use this optional tag if you want to bind a list-based control to a set of data. A good example would be providing the user with a drop down list of states (in the US) or a list of departments in a company or a list of job titles, etc. You can supply more than one <CODE xmlns="http://www.w3.org/1999/xhtml" style="font-size: 9pt;">&lt;ControlDataSource&gt;</CODE> per form definition and you can use the <code xmlns="http://www.w3.org/1999/xhtml" style="font-size: 9pt;">&lt;ControlDataSource&gt;</code> as the source for multiple controls within your form. </p><a name="syntax"></a>
        <h2>Syntax</h2>
        <div>
            <br style="mc-tag-and-class: CODE;" xmlns="" />
            <CODE xmlns="">&lt;ControlDataSource<br xmlns="http://www.w3.org/1999/xhtml" />&#160;&#160;CommandText="<i xmlns="http://www.w3.org/1999/xhtml">string</i>"<br xmlns="http://www.w3.org/1999/xhtml" /> &#160;CommandType="StoredProcedure"<br xmlns="http://www.w3.org/1999/xhtml" />&#160;&#160;ConnectionString="<i>string</i>"<br xmlns="http://www.w3.org/1999/xhtml" />&#160;&#160;Id="<i>string</i>"<br xmlns="http://www.w3.org/1999/xhtml" />&#160;&#160;Source="<i>string</i>"&gt;<br xmlns="http://www.w3.org/1999/xhtml" /> <![CDATA[    ]]><i>Optionally add Parameter tags for any parameters you need</i><br xmlns="http://www.w3.org/1999/xhtml" style="font-style: italic;" /><i>&#160;&#160;&#160; to send to the database.</i></CODE>
            <CODE xmlns="">
                <br />&#160;&#160;&#160;&#160;&lt;Parameter Name="string" Value="string" DataType="data type" /&gt;<br />&#160;&#160;&#160;&#160;...</CODE>
            <br style="mc-tag-and-class: CODE;" xmlns="" />
            <CODE xmlns="">&lt;/ControlDataSource&gt;</CODE>
            <br style="mc-tag-and-class: CODE;" xmlns="" />
            <CODE xmlns=""> <![CDATA[    ]]></CODE>
        </div>&#160;<a name="remarks"></a><h2>Remarks<br xmlns="http://www.w3.org/1999/xhtml" />&#160;</h2><ul><li><b xmlns="http://www.w3.org/1999/xhtml">Id</b>: Name, consisting of letters and numbers, beginning with a letter, that uniquely identifies the control within the form. This attribute is required as it provides the link between the data source and the controls to which it is bound.<br xmlns="http://www.w3.org/1999/xhtml" />&#160;</li><li><b xmlns="http://www.w3.org/1999/xhtml">CommandText</b>: The SQL command to execute to return the data. This attribute is required. Optionally, when <b xmlns="http://www.w3.org/1999/xhtml">Source</b> has been set to <i xmlns="http://www.w3.org/1999/xhtml">dnn</i>, you can specify special values for CommandText to enable retrieval of data from the DotNetNuke database via its API rather than direct database queries (see the Source property description for more details).<br xmlns="http://www.w3.org/1999/xhtml" />&#160;<br xmlns="http://www.w3.org/1999/xhtml" /></li><li><b xmlns="http://www.w3.org/1999/xhtml">CommandType</b>: New to version 4.7. The ControlDataSource tag can now specify to use stored procedures. Specify CommandType="StoredProcedure".<br xmlns="http://www.w3.org/1999/xhtml" />&#160;</li><li><b xmlns="http://www.w3.org/1999/xhtml">ConnectionString</b>: The database connection string for the datasource from which the data will be retrieved. This attribute is optional. XMod Pro will use the connection string for the current DNN database by default. To use connection strings stored in the web.config file, use the [[ConnectionString:<i xmlns="http://www.w3.org/1999/xhtml">connectionStringName</i>]] where connectionStringName is the name assigned to the connection string in the web.config file.<br xmlns="http://www.w3.org/1999/xhtml" />&#160;</li><li><b>Source</b>: New to version 4.0. You can optionally specify "dnn"&#160;(without quotes) as this property's value. When Source is set to dnn, you can retrieve different sets of data using the DNN&#160;API rather than querying the datbase directly. You determine what data you want to retrieve by specifying it in the CommandText property. Currently supported values are:<br xmlns="http://www.w3.org/1999/xhtml" />&#160;<ul style="list-style-type: circle;" xmlns="http://www.w3.org/1999/xhtml"><li><b>Users</b>: Returns a list of users from the current portal</li><li><b>Roles</b>:&#160;Returns a list of security roles in the current portal</li><li><b>Pages</b>:&#160;Returns a list of pages in the current portal</li><li><b>ListCountries</b>: Returns the list of countries defined in the DotNetNuke Lists table.<br xmlns="http://www.w3.org/1999/xhtml" />&#160;</li></ul></li><li><b xmlns="http://www.w3.org/1999/xhtml">&lt;Parameter&gt;</b>: Beginning with version 1.2, the ControlDataSource tag now recognizes <code xmlns="http://www.w3.org/1999/xhtml" style="font-size: 9pt;">&lt;Parameter&gt;</code> child tags. :<br xmlns="http://www.w3.org/1999/xhtml" />&#160;<ul style="list-style-type: circle;" xmlns="http://www.w3.org/1999/xhtml"><li style="font-size: 8pt;"><b>Name</b>: This is the name of the parameter and should be the same as the @param used in your CommandText. </li><li style="font-size: 8pt;"><b>Value</b>: This is the value of the parameter. You can hard-code the value or you can use function tokens like <code style="font-size: 9pt;">[[Url:paramName]]</code> or <code style="font-size: 9pt;">[[Portal:ID]]</code><span style="font-size: 9pt;">,</span> etc. </li></ul></li></ul><p> For each control that will use the data, you need to specify:<br xmlns="http://www.w3.org/1999/xhtml" /></p><ul><li><b xmlns="http://www.w3.org/1999/xhtml">DataSourceId</b>: This is the Id of the <CODE xmlns="http://www.w3.org/1999/xhtml" style="font-size: 9pt;">&lt;ControlDataSource&gt;</CODE> and serves to link the control to the data source.</li><li><b>DataTextField</b>: This is the name of the field  in the data source that contains the value to use for the control's display text.</li><li xmlns=""><b>DataValueField</b>: This is the name of the field in the data source that contains the value to use for the control's hidden text.</li></ul><p>&#160;</p><a href="#top" class="link">Back to top</a><h2>Example</h2><div xmlns=""><code xmlns="http://www.w3.org/1999/xhtml">&lt;AddForm&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&lt;SelectCommand CommandText="SELECT @FirstName AS FirstName, @LastName AS LastName, <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'AZ' AS StateId"&gt;<br />&#160;&#160;&#160;&#160;&lt;Parameter Name="FirstName" Value='[[User:FirstName]]' DefaultValue="" /&gt;<br />&#160;&#160;&#160;&#160;&lt;Parameter Name="LastName" Value='[[User:LastName]]' DefaultValue="" /&gt;<br />&#160;&#160;&lt;/selectcommand&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&lt;SubmitCommand CommandText="INSERT INTO Users(FirstName, 
 LastName, StateId) <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;VALUES(@FirstName, @LastName, @StateId)" /&gt;<br />&#160;<span style="color: #ff0000;">&#160;&lt;ControlDataSource Id="dsStates" ConnectionString="(your connection string here)" </span><br style="color: #ff0000;" /><span style="color: #ff0000;">&#160;&#160;&#160;&#160;&#160;&#160;CommandText="SELECT StateName, StateId FROM States ORDER BY StateName ASC" /&gt;</span></code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&lt;table&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&lt;tr&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&#160; 
 &lt;td&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
 &lt;Label For="txtFirstName" Text="First Name" /&gt; </code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;TextBox Id="txtFirstName" DataField="FirstName" 
 DataType="string" /&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&#160;&#160;&lt;/td&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&lt;/tr&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&lt;tr&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&#160; 
 &lt;td&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
 &lt;Label For="txtLastName" Text="Last Name" /&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;TextBox Id="txtLastName" DataField="LastName" DataType="string" /&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&#160;&#160;
 &lt;/td&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&lt;/tr&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml"><code>&#160;&#160;&#160;&#160;&lt;tr&gt;</code><br style="mc-tag-and-class: code;" /><code>&#160;&#160;&#160;&#160;&#160; 
 &lt;td&gt;</code><br style="mc-tag-and-class: code;" /><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
 &lt;Label For="ddlState" Text="State" /&gt;</code><br style="mc-tag-and-class: code;" /><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;DropdownList Id="ddlState" DataField="StateId" 
 DataType="int32" <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;DataSourceId="dsStates" DataTextField="StateName" DataValueField="StateId" /&gt;</code><br style="mc-tag-and-class: code;" /><code>&#160;&#160;&#160;&#160;&#160;&#160;
 &lt;/td&gt;</code><br style="mc-tag-and-class: code;" /><code>&#160;&#160;&#160;&#160;&lt;/tr&gt;</code><br style="mc-tag-and-class: code;" />&#160;&#160;&#160;&#160;&lt;tr&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&#160; 
 &lt;td colspan="2"&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
 &lt;AddButton Text="Add"/&gt; &lt;CancelButton Text="Cancel" /&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&#160;&#160;&lt;/td&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&lt;/tr&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&lt;/table&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&lt;Email To="</code><code href="mailto:me@mysite.com" xmlns="http://www.w3.org/1999/xhtml">me@mysite.com</code><code xmlns="http://www.w3.org/1999/xhtml">" From="server@mysite.com" Subject="New User Added"</code><code xmlns="http://www.w3.org/1999/xhtml"> Format="html"&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160; 
 A new user has been added:&lt;br /&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&#160;FirstName: [[FirstName]]&lt;br /&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&#160;&#160;&#160;
 LastName: [[LastName]]</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&#160;&#160;&lt;/Email&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">&lt;/AddForm&gt;</code><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml"><br /></code></div><a href="#top">Back to top</a></body>
</html>