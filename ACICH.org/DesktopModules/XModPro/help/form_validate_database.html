<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="4" MadCap:lastHeight="1685" MadCap:lastWidth="1878" class="">
    <head><title></title>
        <link rel="stylesheet" href="XModProHelp.css" type="text/css" />
    </head>
    <body>
        <h1>&lt;Validate Type="database"&gt;</h1><a name="top"></a>
        <p class="Nav"><a href="#syntax">Syntax</a>&#160;<a href="#remarks">Remarks</a>&#160;<a href="#example">Example</a></p>
        <p>The Validate tag whose type is set to "Database" is referred to as a Database Validator and is used to display error messages thrown from the database.</p><a name="syntax"></a>
        <h2>Syntax</h2>
        <div class="Code" xmlns="http://www.w3.org/1999/xhtml"><code xmlns="http://www.w3.org/1999/xhtml">&lt;Validate   </code>
            <br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml"><code>&#160;&#160;&#160;&#160;CssClass="<i>string</i>"<br /> <![CDATA[    ]]></code><code>Text="<i>string</i>"<br />&#160;&#160;&#160;&#160;Type="Database"</code></code>
            <br style="mc-tag-and-class: code;" xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml">  /&gt;&#160; </code>
        </div>&#160;
    
<a name="remarks"></a><h2>Remarks</h2><p>The database validator is a special type of  <code xmlns="http://www.w3.org/1999/xhtml" style="font-size: 9pt;">&lt;Validate&gt;</code> tag. When the "type" attribute is set to <b xmlns="http://www.w3.org/1999/xhtml">Database</b>, the control prevents the form from being submitted if the database throws an error or a value is returned via a specially-named output parameter. Unlike other <span style="font-family: monospace;">&lt;Validate&gt;</span> tags, the database validator is not associated with a specific form control and only one is allowed per form. The database validator is used to display error messages returned from the database. These can be actual errors thrown by the database or a friendly error message returned using the specially named ERROR&#160;output parameter. </p><ul xmlns="http://www.w3.org/1999/xhtml"><li xmlns="http://www.w3.org/1999/xhtml"><b xmlns="http://www.w3.org/1999/xhtml">CssClass</b>:  Name of the Cascading Style Sheets (CSS) class used to style this control.<br xmlns="http://www.w3.org/1999/xhtml" /><br xmlns="http://www.w3.org/1999/xhtml" /></li><li xmlns="http://www.w3.org/1999/xhtml"><b xmlns="http://www.w3.org/1999/xhtml">Text</b>:  This text that will be displayed where your validation fails.  If you have a <span style="font-family: monospace;" xmlns="http://www.w3.org/1999/xhtml">&lt;ValidationSummary&gt;</span> tag on your form then the error message will be displayed there. If this validator has not been placed in your form, the message will still be displayed using the default error reporting mechanism.<br xmlns="http://www.w3.org/1999/xhtml" /><br xmlns="http://www.w3.org/1999/xhtml" /></li><li xmlns="http://www.w3.org/1999/xhtml"><b xmlns="http://www.w3.org/1999/xhtml">Type</b>: When the "type" attribute is set to <b xmlns="http://www.w3.org/1999/xhtml">Database</b>,  the control prevents the form from being submitted if the database throws an error or a value is returned via a specially-named output parameter. Unlike other <span style="font-family: monospace;" xmlns="http://www.w3.org/1999/xhtml">&lt;Validate&gt;</span> tags, the database validator is not associated with a specific form control and only one is allowed per form.</li><li xmlns="http://www.w3.org/1999/xhtml">&#160;</li></ul><p><b style="font-size: 10pt;">Passing a friendly error message back to the form</b>: In some cases your stored procedure may want to inform the user that the data they submitted is invalid in some way. A good example is if a user is choosing a Team Name for a sports league and you want to ensure that no two Team Names are the same. If the user submits a name that already exists, you'd want to inform them of that, allowing them to choose a different name. Here's how you'd do that:</p><ol><li>Set the <code xmlns="http://www.w3.org/1999/xhtml" style="font-size: 9pt;">&lt;SubmitCommand&gt;</code> tag's <code xmlns="http://www.w3.org/1999/xhtml" style="font-size: 9pt; font-family: monospace;">CommandType</code> property to: <code xmlns="http://www.w3.org/1999/xhtml" style="font-size: 9pt; font-family: monospace;">StoredProcedure</code><br xmlns="http://www.w3.org/1999/xhtml" />&#160;</li><li>Add an OUTPUT parameter to the <code xmlns="http://www.w3.org/1999/xhtml" style="font-size: 9pt;">&lt;SubmitCommand&gt;</code>. It <b xmlns="http://www.w3.org/1999/xhtml">*must* be named ERROR</b> and <b xmlns="http://www.w3.org/1999/xhtml">its direction must be set to Output</b> like so:<br xmlns="http://www.w3.org/1999/xhtml" /><code xmlns="http://www.w3.org/1999/xhtml" style="font-size: 9pt;">&lt;Parameter Name="ERROR" DataType="String" Size="250" Direction="Output" /&gt;</code><br xmlns="http://www.w3.org/1999/xhtml" /><br xmlns="http://www.w3.org/1999/xhtml" /></li><li>Optionally (though you will usually do this), add a <code xmlns="http://www.w3.org/1999/xhtml" style="font-size: 9pt;">&lt;Validate Type="Database" /&gt;</code> tag to your form.<br xmlns="http://www.w3.org/1999/xhtml" />&#160;</li><li>Optionally add a <code xmlns="http://www.w3.org/1999/xhtml" style="font-size: 9pt;">&lt;ValidationSummary&gt;</code> tag to your form if you don't already have one.<br xmlns="http://www.w3.org/1999/xhtml" />&#160;</li><li>If you don't use the Validate/ValidationSummary combination of tags, the error will be reported to the end user using the standard XMod Pro reporting mechanisms.<br xmlns="http://www.w3.org/1999/xhtml" />&#160;</li><li>In your stored procedure, set the @ERROR parameter to be an OUTPUT parameter and set its value to whatever message you want to return.<br xmlns="http://www.w3.org/1999/xhtml" />&#160;</li></ol><a href="#top" class="link">Back to top</a> <![CDATA[ ]]><a name="example"></a><h2>Example</h2><div><pre xml:space="preserve">&lt;AddForm&gt;</pre><pre xml:space="preserve">  &lt;SubmitCommand CommandText="XMP_ReturnValueTester" CommandType="StoredProcedure"&gt;</pre><pre xml:space="preserve">    &lt;Parameter Name="FirstName" DataType="String" Size="25" /&gt;</pre><pre xml:space="preserve">    &lt;Parameter Name="LastName" DataType="String" Size="25" /&gt;</pre><pre xml:space="preserve">  &lt;/SubmitCommand&gt;</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">  &lt;div class="xmp-Authors xmp-form"&gt;</pre><pre xml:space="preserve">    &lt;div class="xmp-form-row"&gt;</pre><pre xml:space="preserve">      &lt;Label For="FirstName" Text="First Name" CssClass="NormalBold xmp-form-label" /&gt;</pre><pre xml:space="preserve">      &lt;TextBox id="FirstName" DataField="FirstName" DataType="string" MaxLength="25" Width="165" /&gt;</pre><pre xml:space="preserve">    &lt;/div&gt;</pre><pre xml:space="preserve">    &lt;div class="xmp-form-row"&gt;</pre><pre xml:space="preserve">      &lt;Label For="LastName" Text="Last Name" CssClass="NormalBold xmp-form-label" /&gt;</pre><pre xml:space="preserve">      &lt;TextBox Id="LastName" DataField="LastName" DataType="Decimal" MaxLength="25" Width="165" /&gt;</pre><pre xml:space="preserve">    &lt;/div&gt;</pre><pre xml:space="preserve">    &lt;div class="kbxmFormRow"&gt;</pre><pre xml:space="preserve">      &lt;span class="xmp-form-label"&gt;&amp;nbsp;&lt;/span&gt;</pre><pre xml:space="preserve">      &lt;AddButton Text="Add" CssClass="CommandButton xmp-button"  /&gt; &lt;CancelButton Text="Cancel" CssClass="CommandButton xmp-button" /&gt;</pre><pre xml:space="preserve">      &lt;br /&gt;</pre><pre xml:space="preserve">    &lt;/div&gt;</pre><pre xml:space="preserve">   <![CDATA[    ]]><span style="color: #ff0000;">&lt;Validate Type="Database" /&gt;</span></pre><pre xml:space="preserve">    &#160;&#160;&lt;ValidationSummary DisplayMode="BulletList"  CssClass="NormalRed xmp-validation-summary" /&gt;</pre><pre xml:space="preserve">  &lt;/div&gt;</pre><pre xml:space="preserve">&lt;/AddForm&gt;</pre><pre xml:space="preserve">&#160;</pre><p>Here's a sample stored procedure that is guaranteed to throw an error:</p><p>&#160;</p><pre xml:space="preserve">CREATE PROCEDURE [dbo].[XMP_DBThrownError_Tester]</pre><pre xml:space="preserve">  @FirstName nvarchar(255),</pre><pre xml:space="preserve">  @LastName nvarchar(255)</pre><pre xml:space="preserve">AS</pre><pre xml:space="preserve">BEGIN</pre><pre xml:space="preserve">  RAISERROR('Example Error Thrown',18,1)</pre><pre xml:space="preserve">END</pre><p>&#160;</p><p>Here's what the example form looks like after the user has submitted the form and the stored procedure has thrown the error:</p><p>&#160;</p><pre xml:space="preserve"><img src="Resources/Images/Validate_Database_InAction.png" xmlns="http://www.w3.org/1999/xhtml" /></pre></div><a href="#top">Back to top</a></body>
</html>